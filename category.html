<!doctype html>
<html class="no-js" lang="zxx">
    <head>
        <title>E-Commerce</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.css" integrity="sha512-UTNP5BXLIptsaj5WdKFrkFov94lDx+eBvbKyoe1YAfjeRPC+gT5kyZ10kOHCfNZqEui1sxmqvodNUx3KbuYI/A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="https://cdn.usebootstrap.com/bootstrap/4.1.3/css/bootstrap.min.css">
        <link rel="stylesheet" href="css/helper.css">
        <link rel="stylesheet" href="style.css"> 
    </head>
    <body>
    <!--[if lt IE 8]>
		<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
	<![endif]-->
        <!-- Begin Body Wrapper -->
        <div class="body-wrapper">
            <!-- Begin Header Area -->
            <header class="header">
                <!-- Begin Header Top Area -->
                <div class="header-top">
                    <div class="container">
                        <div class="ht-menu">
                            <ul>
                                <li><a href="index.html">Home</a></li>
                                <li><a href="account.html">My Account</a></li>
                                <li><a href="shopping-cart.html">Cart</a></li>
                                <li><a href="checkout.html">Checkout</a></li>
                                <li><a id="sign-in-link" href="sign-in.html">Sign In</a></li>          
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- Header Top Area End Here -->
                <!-- Begin Header Middle Area -->
                <div class="header-middle">
                    <div class="container">
                        <div class="row">
                            <div class="col-3">
                                <div class="logo">
                                    <a href="index.html">
                                        <img src="images/logo/site-logo.jpg" alt="">
                                    </a>
                                </div>
                            </div>
                            <div class="col-9 hm-searchbox-area">
                                <div class="hm-searchbox">
                                    <form action="#">
                                        <select>
                                            <option value="0">All</option>                         
                                            <option value="10">Laptops & Tablets</option>                     
                                            <option value="10">Electronics & Accessories</option>    
                                            <option value="10">Printers</option>
                                        </select>
                                        <input type="text" placeholder="Enter your search key ...">
                                    </form>
                                </div>
                                <p id="welcome-message"></p>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Header Middle Area End Here -->
                <!-- Begin Header Bottom Area -->
                <div class="header-bottom header-sticky stick">
                    <div class="container">
                        <div class="hb-menu">
                            <ul>
                                <li class="megamenu-holder"><a>Browse</a><i class="fa fa-angle-down"></i>
                                    <ul class="megamenu">
                                        <li><a href="category.html?category=1&subcategory=&categoryName=2">Laptops & Tablets</a>
                                            <br>
                                            <ul>
                                                <li><a href="category.html?category=1&subcategory=1">Laptops</a></li>
                                                <li><a href="category.html?category=1&subcategory=2">Tablets</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="category.html?category=2&subcategory=">Electronics & Accessories</a>
                                            <br>
                                            <ul>
                                                <li><a href="category.html?category=2&subcategory=3">Keyboards & Mice</a></li>
                                                <li><a href="category.html?category=2&subcategory=4">Audio</a></li>
                                                <li><a href="category.html?category=2&subcategory=5">Hard Drives, SSDs & Storage</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="category.html?category=3&subcategory=">Printers</a>
                                            <br>
                                            <ul>
                                                <li><a href="category.html?category=3&subcategory=6">Inkjet Printers</a></li>
                                                <li><a href="category.html?category=3&subcategory=7">Laser Printers</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="category.html?category=1&subcategory=">Laptops & Tablets</a></li>
                                <li><a href="category.html?category=2&subcategory=">Electronics & Accessories</a></li>
                                <li><a href="category.html?category=3&subcategory=">Printers</a></li>
                                <li class="megamenu-holder"><a>Pages</a><i class="fa fa-angle-down"></i>
                                    <ul class="megamenu">
                                        <li>
                                            <ul>
                                                <li><a href="index.html">Home</a></li>
                                                <li><a href="account.html">My Account</a></li>
                                                <li><a href="shopping-cart.html">Shopping Cart</a></li>
                                                <li><a href="checkout.html">Checkout</a></li>
                                                <li><a href="contact.html">Contact</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- Header Bottom Area End Here -->
            </header>
            <!-- Header Area End Here -->
            <!-- Begin Breadcrumb Area -->
            <div class="breadcrumb-area">
                <div class="container">
                    <div class="breadcrumb-content">
                        <ul>
                            <li><a href="index.html">Home</a></li>
                            <li id="breadcrumb-category" class="active"></li>
                            <li id="breadcrumb-subcategory" class="active"></li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- Breadcrumb Area End Here -->
            <!-- Begin Content Wrapper Area -->
            <div class="content-wrapper mb-50">
                <div class="container">
                    <div class="row">
                        <div class="col-3">
                            <div class="sidebar-categores-box">
                                <div class="sidebar-title">
                                    <h2>Filters</h2>
                                    <i class="fas fa-filter" style="font-size: 16px; color: #e1e1e1;"></i>
                                </div><hr>
                                <!-- filter-sub-area start -->
                                <div class="filter-sub-area">
                                    <h5>Brands</h5>
                                    <ul>
                                        <!-- list of brans will be inserted here -->
                                        <!-- <li><input type="checkbox" name="product-categori"><a href="#">Dell</a></li>
                                        <li><input type="checkbox" name="product-categori"><a href="#">Toshiba</a></li>
                                        <li><input type="checkbox" name="product-categori"><a href="#">SAMSUNG</a></li>
                                        <li><input type="checkbox" name="product-categori"><a href="#">Seagate</a></li>
                                        <li><input type="checkbox" name="product-categori"><a href="#">Western Digital</a></li> -->
                                    </ul>
                                 </div>
                                <!-- filter-sub-area end -->
                            </div>
                        </div>
                        <div class="col-9">
                            <div class="shop-top-bar">
                                <div class="quantity-select">
                                    <label>Sort by</label>
                                    <select>
                                        <option>Relevance</option>
                                        <option>Price: Low to High</option>
                                        <option>Price: High to Low</option>
                                        <option>Newest Arrivals</option>
                                    </select>
                                </div>
                            </div>
                            <div class="shop-products-wrapper">
                                <div class="shop-product-area">
                                    <div class="row">
                                        <!-- products will be inserted here -->
                                    </div>
                                </div>
                            </div>
                            <div class="paginatoin-area">
                                <div class="row">
                                    <div class="col-6">
                                        <p>Showing 1-12 of 13 item(s)</p>
                                    </div>
                                    <div class="col-6">
                                        <ul class="pagination-box">
                                            <li><a href="#" class="Previous"><i class="fa fa-chevron-left"></i> Previous</a>
                                            </li>
                                            <li class="active"><a href="#">1</a></li>
                                            <li><a href="#">2</a></li>
                                            <li><a href="#">3</a></li>
                                            <li>
                                              <a href="#" class="Next"> Next <i class="fa fa-chevron-right"></i></a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Content Wrapper Area End Here -->
            <!-- Begin Footer Area -->
            <div class="footer">
                <!-- Begin Footer Static Top Area -->
                <div class="footer-static-top">
                    <div class="container">
                        <!-- Begin Footer Shipping Area -->
                        <div class="footer-shipping pt-60 pb-55 pb-xs-25">
                            <div class="row">
                                <!-- Begin Li's Shipping Inner Box Area -->
                                <div class="col-lg-3 col-md-6 col-sm-6 pb-sm-55 pb-xs-55">
                                    <div class="li-shipping-inner-box">
                                        <div class="shipping-icon">
                                            <img src="images/shipping-icon/1.png" alt="Shipping Icon">
                                        </div>
                                        <div class="shipping-text">
                                            <h2>Free Delivery</h2>
                                            <p>And free returns. See checkout for delivery dates.</p>
                                        </div>
                                    </div>
                                </div>
                                <!-- Li's Shipping Inner Box Area End Here -->
                                <!-- Begin Li's Shipping Inner Box Area -->
                                <div class="col-lg-3 col-md-6 col-sm-6 pb-sm-55 pb-xs-55">
                                    <div class="li-shipping-inner-box">
                                        <div class="shipping-icon">
                                            <img src="images/shipping-icon/2.png" alt="Shipping Icon">
                                        </div>
                                        <div class="shipping-text">
                                            <h2>Safe Payment</h2>
                                            <p>Pay with the world's most popular and secure payment methods.</p>
                                        </div>
                                    </div>
                                </div>
                                <!-- Li's Shipping Inner Box Area End Here -->
                                <!-- Begin Li's Shipping Inner Box Area -->
                                <div class="col-lg-3 col-md-6 col-sm-6 pb-xs-30">
                                    <div class="li-shipping-inner-box">
                                        <div class="shipping-icon">
                                            <img src="images/shipping-icon/3.png" alt="Shipping Icon">
                                        </div>
                                        <div class="shipping-text">
                                            <h2>Shop with Confidence</h2>
                                            <p>Our Buyer Protection covers your purchasefrom click to delivery.</p>
                                        </div>
                                    </div>
                                </div>
                                <!-- Li's Shipping Inner Box Area End Here -->
                                <!-- Begin Li's Shipping Inner Box Area -->
                                <div class="col-lg-3 col-md-6 col-sm-6 pb-xs-30">
                                    <div class="li-shipping-inner-box">
                                        <div class="shipping-icon">
                                            <img src="images/shipping-icon/4.png" alt="Shipping Icon">
                                        </div>
                                        <div class="shipping-text">
                                            <h2>24/7 Help Center</h2>
                                            <p>Have a question? Call a Specialist or chat online.</p>
                                        </div>
                                    </div>
                                </div>
                                <!-- Li's Shipping Inner Box Area End Here -->
                            </div>
                        </div>
                        <!-- Footer Shipping Area End Here -->
                    </div>
                </div>
                <!-- Footer Static Top Area End Here -->
            </div>
            <!-- Footer Area End Here -->
        </div>
        <!-- Body Wrapper End Here -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha512-jGsMH83oKe9asCpkOVkBnUrDDTp8wl+adkB2D+//JtlxO4SrLoJdhbOysIFQJloQFD+C4Fl1rMsQZF76JjV0eQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdn.usebootstrap.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js" integrity="sha512-bPs7Ae6pVvhOSiIcyUClR7/q2OAsRiovw4vAkX+zJbw3ShAeeqezq50RIIcIURq7Oa20rW2n2q+fyXBNcU9lrw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="js/jquery.meanmenu.min.js"></script>
        <script src="js/main.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function () {

                checkSignInStatus();

                const params = new URLSearchParams(window.location.search);

                const categoryId = params.get('category');
                const subcategoryId = params.get('subcategory');

                let apiURL;
                if (subcategoryId !== null) {
                    apiURL = `http://localhost:8080/products/category-subcategory?categoryId=${categoryId}&subcategoryId=${subcategoryId}`;
                } else {
                    apiURL = `http://localhost:8080/products/category-subcategory?categoryId=${categoryId}`;
                }

                fetch(apiURL) 
                .then(response => {
                    return response.json();
                })
                .then(data => {
                    const productsContainer = document.querySelector('.shop-product-area .row');
                    data.forEach(product => {
                        const productElement = document.createElement('div');
                        productElement.className = 'col-4';

                        // Generate star rating
                        let starRating = '';
                        for (let i = 1; i <= 5; i++) {
                            let star = document.createElement('span');
                            star.className = 'star';
                            star.textContent = '★';
                            if (i > Math.ceil(2.5)) {
                                star.classList.add('empty'); // Use classList.add for adding classes
                            } else if (i > 2.5) {
                                star.classList.add('half');
                            }
                            starRating += star.outerHTML;
                        }

                        productElement.innerHTML = `
                            <div class="single-product-wrap">
                                <div class="product-image">
                                    <a href="product-details.html?product=${product.id}">
                                        <img src="images/product/large-size/${product.name}.jpg">
                                    </a>
                                </div>
                                <div class="product-desc">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span class="product-manufacturer">${product.manufacturer}</span>
                                        <span class="star-rating">${starRating}</span>
                                    </div>
                                    <hr>
                                    <p class="product-name"><a href="product-details.html?product=${product.id}">${product.name}</a></p>
                                    <hr>
                                    <span class="product-price">$ ${product.price.toFixed(2)}</span>
                                </div>
                            </div>
                        `;
                        productsContainer.appendChild(productElement);
                    });
                    const brands = [...new Set(data.map(product => product.manufacturer))];
                    const brandList = document.querySelector('.filter-sub-area ul');

                    brands.forEach(brand => {
                        const listItem = `
                            <li>
                                <input type="checkbox" name="product-categori">
                                <a href="#">${brand}</a>
                            </li>
                        `;
                        brandList.innerHTML += listItem;
                    });

                })
                .catch(error => {

                });

            });
        </script>
    </body>
</html>
