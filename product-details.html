<!doctype html>
<html class="no-js" lang="zxx">
    <head>
        <title>E-Commerce</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.css" integrity="sha512-UTNP5BXLIptsaj5WdKFrkFov94lDx+eBvbKyoe1YAfjeRPC+gT5kyZ10kOHCfNZqEui1sxmqvodNUx3KbuYI/A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="https://cdn.usebootstrap.com/bootstrap/4.1.3/css/bootstrap.min.css">
        <link rel="stylesheet" href="css/helper.css">
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
    <!--[if lt IE 8]>
		<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
	<![endif]-->
        <!-- Begin Body Wrapper -->
        <div class="body-wrapper">
            <!-- Begin Header Area -->
            <header class="header">
                <!-- Begin Header Top Area -->
                <div class="header-top">
                    <div class="container">
                        <div class="ht-menu">
                            <span>Telephone Enquiry:(+123) 123 321 345</span>
                            <ul>
                                <li><a href="index.html">Home</a></li>
                                <li><a href="account.html">My Account</a></li>
                                <li><a href="shopping-cart.html">Cart</a></li>
                                <li><a href="checkout.html">Checkout</a></li>
                                <li><a id="sign-in-link" href="sign-in.html">Sign In</a></li>    
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- Header Top Area End Here -->
                <!-- Begin Header Middle Area -->
                <div class="header-middle">
                    <div class="container">
                        <div class="row">
                            <div class="col-3">
                                <div class="logo">
                                    <a href="index.html">
                                        <img src="images/logo/site-logo.jpg" alt="">
                                    </a>
                                </div>
                            </div>
                            <div class="col-9 hm-searchbox-area">
                                <div class="hm-searchbox">
                                    <form action="#">
                                        <select>
                                            <option value="0">All</option>                         
                                            <option value="10">Laptops & Tablets</option>                     
                                            <option value="10">Electronics & Accessories</option>    
                                            <option value="10">Printers</option>
                                        </select>
                                        <input type="text" placeholder="Enter your search key ...">
                                    </form>
                                </div>
                                <p>Hello, <span id="greet-user">guest</span></p>
                                <div class="cart-container">
                                    <a href="shopping-cart.html">
                                        <img src="images/icon/cart.png" alt="" width="50px">
                                        <span id="cart-number" class="cart-number">0</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Header Middle Area End Here -->
                <!-- Begin Header Bottom Area -->
                <div class="header-bottom header-sticky">
                    <div class="container">
                        <!-- Begin Header Bottom Menu Area -->
                        <div class="hb-menu">
                            <nav>
                                <ul>
                                    <li class="dropdown-holder"><a href="category.html?categoryId=1&categoryName=Laptops%20%26%20Tablets">Laptops & Tablets</a>
                                        <ul class="hb-dropdown">
                                            <li><a href="category.html?categoryId=1&categoryName=Laptops%20%26%20Tablets&subcategoryId=1&subcategoryName=Laptops">Laptops</a></li>
                                            <li><a href="category.html?categoryId=1&categoryName=Laptops%20%26%20Tablets&subcategoryId=2&subcategoryName=Tablets">Tablets</a></li>
                                        </ul>
                                    </li>
                                    <li class="dropdown-holder"><a href="category.html?categoryId=2&categoryName=Electronics%20%26%20Accessories">Electronics & Accessories</a>
                                        <ul class="hb-dropdown">
                                            <li><a href="category.html?categoryId=2&categoryName=Electronics%20%26%20Accessories&subcategoryId=3&subcategoryName=Keyboards%20%26%20Mice">Keyboards & Mice</a></li>
                                            <li><a href="category.html?categoryId=2&categoryName=Electronics%20%26%20Accessories&subcategoryId=4&subcategoryName=Audio">Audio</a></li>
                                            <li><a href="category.html?categoryId=2&categoryName=Electronics%20%26%20Accessories&subcategoryId=5&subcategoryName=Hard%20Drives,%20SSDs%20%26%20Storage">Hard Drives, SSDs & Storage</a></li>
                                        </ul>
                                    </li>
                                    <li class="dropdown-holder"><a href="category.html?categoryId=3&categoryName=Printers">Printers</a>
                                        <ul class="hb-dropdown">
                                            <li><a href="category.html?categoryId=3&categoryName=Printers&subcategoryId=6&subcategoryName=Inkjet%20Printers">Inkjet Printers</a></li>
                                            <li><a href="category.html?categoryId=3&categoryName=Printers&subcategoryId=7&subcategoryName=Laser%20Printers">Laser Printers</a></li>
                                        </ul>
                                    </li>
                                    <div class="hb-right">
                                        <li><a href="#">Featured</a></li>
                                        <li><a href="#">New Arrivals</a></li>
                                        <li><a href="#">Best Sellers</a></li>
                                    </div>
                                </ul>
                            </nav>
                        </div>
                        <!-- Header Bottom Menu Area End Here -->
                    </div>
                </div>
                <!-- Header Bottom Area End Here -->
            </header>
            <!-- Header Area End Here -->
            <!-- Begin Breadcrumb Area -->
            <div class="breadcrumb-area">
                <div class="container">
                    <div class="breadcrumb-content">
                        <ul>
                            <li><a href="index.html">Home</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- Breadcrumb Area End Here -->
            <!-- Begin Product Details Area -->
            <div class="product-details-area mb-50">
                <div class="container">
                    <!-- product details will be inserted here -->
                </div>
            </div>
            <!-- Product Details Area End Here -->
            <!-- Begin Product Area -->
            <div class="product-area mb-50">
                <div class="container">
                    <div class="product-tab">
                        <div class="section-title">
                            <h2>
                                <ul class="nav">
                                    <li><a class="active" data-toggle="tab" href="#product-info">About this item</a></li>
                                    <li><a data-toggle="tab" href="#support">Warranty, Shipping & Returns</a></li>
                                 </ul>  
                            </h2>
                        </div>             
                    </div>
                    <div class="tab-content">
                        <div id="product-info" class="tab-pane active show" role="tabpanel">
                            <div class="row">
                                <div class="col-6">
                                    <table class="product-info">
                                        <!-- product information will be inserted here -->
                                    </table>
                                </div>
                                <div class="col-6">
                                    <!-- Begin Frequently Accordin -->
                                    <div class="frequently-accordion">
                                        <div id="accordion">
                                            <div class="card actives">
                                                <div class="card-header" id="headingOne">
                                                    <h5>
                                                        <a class="" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                                            Product Specifications Disclaimer
                                                        </a>
                                                    </h5>
                                                </div>
                                                <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
                                                    <div class="card-body">
                                                        Product specifications are provided by our manufacturers and suppliers and may be subject to change without notice. Actual product may vary slightly in terms of size, weight, color, or other listed features from what is mentioned on the website. We recommend customers to verify the product specifications with the manufacturer’s website or contact our customer service for any clarifications before making a purchase.
                                                    </div>
                                                </div>
                                            </div>
                                            <p>Have questions to ask? Please message us here.</p>
                                            <br>
                                            <div class="card">
                                                <div class="card-header" id="headingTwo">
                                                    <h5>
                                                        <a class="collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                                        Donec mattis finibus elit ut tristique?
                                                        </a>
                                                    </h5>
                                                </div>
                                                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
                                                    <div class="card-body">
                                                        Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin coffee nulla assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings occaecat craft beer farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them accusamus labore sustainable VHS.
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!--Frequently Accordin End Here -->
                                </div>
                            </div>     
                        </div>
                        <div id="support" class="tab-pane" role="tabpanel">
                            <div class="support">
                                <span>The best is yet to come! Give your walls a voice with a framed poster. This aesthethic, optimistic poster will look great in your desk or in an open-space office. Painted wooden frame with passe-partout for more depth.</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Product Area End Here -->
            <!-- Begin Footer Area -->
            <div class="footer">
                <!-- Begin Footer Static Top Area -->
                <div class="footer-static-top">
                    <div class="container">
                        <!-- Begin Footer Shipping Area -->
                        <div class="footer-shipping pt-60 pb-55 pb-xs-25">
                            <div class="row">
                                <!-- Begin Li's Shipping Inner Box Area -->
                                <div class="col-lg-3 col-md-6 col-sm-6 pb-sm-55 pb-xs-55">
                                    <div class="li-shipping-inner-box">
                                        <div class="shipping-icon">
                                            <img src="images/shipping-icon/1.png" alt="Shipping Icon">
                                        </div>
                                        <div class="shipping-text">
                                            <h2>Free Delivery</h2>
                                            <p>And free returns. See checkout for delivery dates.</p>
                                        </div>
                                    </div>
                                </div>
                                <!-- Li's Shipping Inner Box Area End Here -->
                                <!-- Begin Li's Shipping Inner Box Area -->
                                <div class="col-lg-3 col-md-6 col-sm-6 pb-sm-55 pb-xs-55">
                                    <div class="li-shipping-inner-box">
                                        <div class="shipping-icon">
                                            <img src="images/shipping-icon/2.png" alt="Shipping Icon">
                                        </div>
                                        <div class="shipping-text">
                                            <h2>Safe Payment</h2>
                                            <p>Pay with the world's most popular and secure payment methods.</p>
                                        </div>
                                    </div>
                                </div>
                                <!-- Li's Shipping Inner Box Area End Here -->
                                <!-- Begin Li's Shipping Inner Box Area -->
                                <div class="col-lg-3 col-md-6 col-sm-6 pb-xs-30">
                                    <div class="li-shipping-inner-box">
                                        <div class="shipping-icon">
                                            <img src="images/shipping-icon/3.png" alt="Shipping Icon">
                                        </div>
                                        <div class="shipping-text">
                                            <h2>Shop with Confidence</h2>
                                            <p>Our Buyer Protection covers your purchasefrom click to delivery.</p>
                                        </div>
                                    </div>
                                </div>
                                <!-- Li's Shipping Inner Box Area End Here -->
                                <!-- Begin Li's Shipping Inner Box Area -->
                                <div class="col-lg-3 col-md-6 col-sm-6 pb-xs-30">
                                    <div class="li-shipping-inner-box">
                                        <div class="shipping-icon">
                                            <img src="images/shipping-icon/4.png" alt="Shipping Icon">
                                        </div>
                                        <div class="shipping-text">
                                            <h2>24/7 Help Center</h2>
                                            <p>Have a question? Call a Specialist or chat online.</p>
                                        </div>
                                    </div>
                                </div>
                                <!-- Li's Shipping Inner Box Area End Here -->
                            </div>
                        </div>
                        <!-- Footer Shipping Area End Here -->
                    </div>
                </div>
                <!-- Footer Static Top Area End Here -->
            </div>
            <!-- Footer Area End Here -->
        </div>
        <!-- Body Wrapper End Here -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha512-jGsMH83oKe9asCpkOVkBnUrDDTp8wl+adkB2D+//JtlxO4SrLoJdhbOysIFQJloQFD+C4Fl1rMsQZF76JjV0eQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdn.usebootstrap.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js" integrity="sha512-bPs7Ae6pVvhOSiIcyUClR7/q2OAsRiovw4vAkX+zJbw3ShAeeqezq50RIIcIURq7Oa20rW2n2q+fyXBNcU9lrw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="js/jquery.meanmenu.min.js"></script>
        <script src="js/main.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function () {

                checkSignInStatus();
                getCartNumber();

                const params = new URLSearchParams(window.location.search);

                const productId = params.get('product');

                // fetch product details
                fetch(`http://localhost:8080/products/${productId}`) 
                    .then(response => {
                        return response.json();
                    })
                    .then(product => {

                        // Get the breadcrumb list
                        let breadcrumbList = document.querySelector('.breadcrumb-content ul');

                        // Set the breadcrumb content
                        let categoryLi = document.createElement('li');
                        categoryLi.innerHTML = `<a href="category.html?categoryId=${product.categoryId}&categoryName=${encodeURIComponent(product.categoryName)}">${product.categoryName}</a>`;
                        breadcrumbList.appendChild(categoryLi);

                        let subcategoryLi = document.createElement('li');
                        subcategoryLi.innerHTML = `<a href="category.html?categoryId=${product.categoryId}&categoryName=${encodeURIComponent(product.categoryName)}&subcategoryId=${product.subcategoryId}&subcategoryName=${encodeURIComponent(product.subcategoryName)}">${product.subcategoryName}</a>`;
                        breadcrumbList.appendChild(subcategoryLi);

                        let emptyLi = document.createElement('li');
                        emptyLi.innerHTML = '';
                        breadcrumbList.appendChild(emptyLi);

                        const productsContainer = document.querySelector('.product-details-area .container');
                        const productElement = document.createElement('div');
                        productElement.className = 'row';
                        productElement.innerHTML = `
                            <div class="col-4">
                                <div class="product-details-left">
                                    <img src="images/product/large-size/${product.productName}.jpg" alt="product image">
                                    <p>Images for illustrative purposes only - actual items may differ from images or based on configurations selected.</p>
                                </div>       
                            </div>
                            <div class="col-8">
                                <div class="product-details-right">
                                    <div>
                                        <h2>${product.productName}</h2>
                                    </div>
                                    <div style="border-bottom: 1px solid #e1e1e1;">
                                        <p>${product.description}</p>
                                    </div>
                                    <div class="row">
                                        <div class="col-8">
                                            <div class="add-to-cart-div">
                                                <div class="product-tag-container2">
                                                    ${product.productTag.newArrival ? '<div class="product-tag new-arrival">New Arrival</div>' : ''}
                                                    ${product.productTag.bestSeller ? '<div class="product-tag best-seller">Best Seller</div>' : ''}
                                                </div>
                                                <div class="price-div">
                                                    <p style="font-size: 20px; font-weight: bold;">$ ${product.price.toFixed(2)}</p>
                                                    <p>
                                                        <div class="my-tooltip">Price above includes tax.
                                                            <div class="tooltip-position">
                                                                <div class="tooltip-top">
                                                                    <p>Price above includes tax.</p>
                                                                </div>
                                                                <div class="tooltip-bottom">
                                                                    <p>The displayed price already accounts for all applicable taxes, ensuring that there are no additional charges beyond what you see.</p>
                                                                </div>
                                                                <i></i>
                                                            </div>
                                                        </div>
                                                    </p>
                                                </div>
                                                <div>
                                                    <p style="font-size: 20px; color: #FF0000; margin-bottom: 5px;">Stock Left: ${product.quantityInStock} <span style="font-size: 12px;"> <a href="#" onclick="showMore(event)" style="color: #0673ca;">See more details <i class="fa fa-angle-down" aria-hidden="true"></i></a></span></p>
                                                    <form action="#"></form>
                                                        <div class="quantity-select">
                                                            <select>
                                                                <option value="1">Quantity: 1</option>
                                                                <option value="2">2</option>
                                                                <option value="3">3</option>
                                                                <option value="4">4</option>
                                                                <option value="5">5</option>
                                                                <option value="6">6</option>
                                                                <option value="7">7</option>
                                                                <option value="8">8</option>
                                                                <option value="9">9</option>
                                                                <option value="10">10</option>
                                                            </select>
                                                        </div>
                                                        <input type="hidden" name="product-id" value="${product.productId}">
                                                        <div style="margin-top: 10px;">
                                                            <button type="submit" id="add-to-cart" class="my-button" style="margin-right: 10px;">Add to Cart</button>
                                                            <button type="submit" id="checkout" class="my-button-inverse">Checkout This Item</button>
                                                        </div>
                                                        <div class="col-12 cart-message">
                                                            <div>
                                                                <p></p>
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                                <div class="block-reassurance">
                                                    <table>
                                                        <tr>
                                                            <td>
                                                                <i class="fas fa-shipping-fast"></i>
                                                            </td>
                                                            <td>
                                                                <div class="my-tooltip" >Timely and Reliable Delivery
                                                                    <div class="tooltip-position">
                                                                        <div class="tooltip-top">
                                                                            <p>Timely and Reliable Delivery</p>
                                                                        </div>
                                                                        <div class="tooltip-bottom">
                                                                            <p>You can expect your orders to arrive consistently on schedule, backed by a reliable delivery service.</p>
                                                                        </div>
                                                                        <i></i>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>
                                                                <i class="fas fa-exchange"></i>
                                                            </td>
                                                            <td>
                                                                <div class="my-tooltip">Eligible for Return, Refund or Replacement within 30 Days
                                                                    <div class="tooltip-position">
                                                                        <div class="tooltip-top">
                                                                            <p>Eligible for Return, Refund or Replacement within 30 Days</p>
                                                                        </div>
                                                                        <div class="tooltip-bottom">
                                                                            <p>You can return this product in its original state within 30 days of receiving it for a full refund or a replacement.</p>
                                                                        </div>
                                                                        <i></i>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>
                                                                <i class="far fa-credit-card"></i>
                                                            </td>
                                                            <td>
                                                                <div class="my-tooltip">Secure Transaction
                                                                    <div class="tooltip-position">
                                                                        <div class="tooltip-top">
                                                                            <p>Secure Transaction</p>
                                                                        </div>
                                                                        <div class="tooltip-bottom">
                                                                            <p>Our relentless commitment is to ensure the utmost protection for your security and privacy, and to safeguard your sensitive information.</p>
                                                                        </div>
                                                                        <i></i>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </table>                                
                                                </div>    
                                            </div>
                                        </div>
                                        <div class="col-4">
                                            <div class="product-details-table-div">
                                                <table class="product-details-table">
                                                    <tr>
                                                        <th>Manufacturer</td>
                                                        <td><img src="images/logo/manufacturer's logo/${product.manufacturer}.jpg" title="${product.manufacturer}" width="100%"></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Ships from</td>
                                                        <td>E-Commerce.com</td>
                                                    </tr>
                                                    <tr>
                                                        <th>Sold by</td>
                                                        <td>E-Commerce.com</td>
                                                    </tr>
                                                    <tr>
                                                        <th>Delivery</th>
                                                        <td>
                                                            <p>Estimated between Jan 1, 2024 and Jan 3, 2024.</p> 
                                                            <p id="moreText" style="display: none; color: #FF0000;">Delivery time varies based on buyer proximity, chosen postage, seller history, and factors, especially during peak periods.</p>
                                                            <a href="#" id="moreLink" onclick="showMore(event)" style="color: #0673ca;">See more details <i class="fa fa-angle-down" aria-hidden="true"></i></a>
                                                            <a href="#" id="lessLink" style="display: none;" onclick="showLess(event)" style="color: #0673ca;">See less details <i class="fa fa-angle-up" aria-hidden="true"></i></a>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th>Returns</td>
                                                        <td>Returnable until Jan 31, 2024. Buyer pays for return shipping. <a href="#" style="color: #0673ca;">Learn More</a></td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>  
                                </div>
                            </div> 
                        `;
                        productsContainer.appendChild(productElement);

                        // populate info table
                        let table = document.querySelector("#product-info table");
                        product.productSpecs.map(spec => {
                            let row = document.createElement("tr");
                            let nameCell = document.createElement("td");
                            let valueCell = document.createElement("td");

                            nameCell.textContent = spec.specName;
                            valueCell.textContent = spec.specValue;

                            row.appendChild(nameCell);
                            row.appendChild(valueCell);

                            table.appendChild(row);
                        });

                        document.querySelector('#add-to-cart').addEventListener('click', function(e) {
                            e.preventDefault();

                            // Get user id from session
                            const userId = sessionStorage.getItem('userId');

                            // Get product id from hidden input field
                            const productId = document.querySelector('input[name="product-id"]').value;

                            // Get selected quantity
                            const quantity = document.querySelector('.quantity-select select').value;

                            fetch(`http://localhost:8080/carts/${userId}/cart-items`, {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify({ 
                                    productId: productId, 
                                    quantity: quantity 
                                }),
                            })
                                .then(response => {
                                    return response.json();
                                })
                                .then(data => {
                                    document.querySelector('.cart-message').style.display = 'block';
                                    document.querySelector('.cart-message p').innerText = 'Added to cart';

                                })
                                .catch(error => {
                                    console.error(error);
                                });
                        });
                    })
                    .catch(error => {
                        console.error(error);
                    });
            });
        </script>
        <script>
            function showMore(e) {
                e.preventDefault();
                document.getElementById('moreText').style.display = 'inline';
                document.getElementById('moreLink').style.display = 'none';
                document.getElementById('lessLink').style.display = 'inline';
            }
        
            function showLess(e) {
                e.preventDefault();
                document.getElementById('moreText').style.display = 'none';
                document.getElementById('moreLink').style.display = 'inline';
                document.getElementById('lessLink').style.display = 'none';
            }
        </script>
    </body>
</html>
