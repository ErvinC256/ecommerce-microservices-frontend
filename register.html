<!doctype html>
<html class="no-js" lang="zxx">
    <head>
        <title>E-Commerce</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.css" integrity="sha512-UTNP5BXLIptsaj5WdKFrkFov94lDx+eBvbKyoe1YAfjeRPC+gT5kyZ10kOHCfNZqEui1sxmqvodNUx3KbuYI/A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="https://cdn.usebootstrap.com/bootstrap/4.1.3/css/bootstrap.min.css">
        <link rel="stylesheet" href="css/helper.css">
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
    <!--[if lt IE 8]>
		<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
	<![endif]-->
        <!-- Begin Body Wrapper -->
        <div class="body-wrapper">
            <!-- Begin Header Area -->
            <header class="header">
                <!-- Begin Header Top Area -->
                <div class="header-top">
                    <div class="container">
                        <div class="ht-menu">
                            <ul>
                                <li><a href="index.html">Home</a></li>
                                <li><a href="account.html">My Account</a></li>
                                <li><a href="shopping-cart.html">Cart</a></li>
                                <li><a href="checkout.html">Checkout</a></li>
                                <li id="sign-in-link"><a href="sign-in.html">Sign In</a></li>   
                                <script>
                                    let signInLink = document.getElementById('sign-in-link');
                                    if (sessionStorage.getItem('loggedIn')) {
                                        signInLink.innerHTML = '<a href="#" onclick="signOut()">Sign Out</a>';
                                    }
                                </script>              
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- Header Top Area End Here -->
                <!-- Begin Header Middle Area -->
                <div class="header-middle">
                    <div class="container">
                        <div class="row">
                            <div class="col-3">
                                <div class="logo">
                                    <a href="index.html">
                                        <img src="images/menu/logo/1.jpg" alt="">
                                    </a>
                                </div>
                            </div>
                            <div class="col-9">
                                <div class="hm-searchbox">
                                    <form action="#">
                                        <select>
                                            <option value="0">All</option>                         
                                            <option value="10">Laptops & Tablets</option>                     
                                            <option value="10">Electronics & Accessories</option>    
                                            <option value="10">Printers</option>
                                        </select>
                                        <input type="text" placeholder="Enter your search key ...">
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Header Middle Area End Here -->
                <!-- Begin Header Bottom Area -->
                <div class="header-bottom header-sticky stick">
                    <div class="container">
                        <div class="hb-menu">
                            <ul>
                                <li class="megamenu-holder"><a>Browse</a><i class="fa fa-angle-down"></i>
                                    <ul class="megamenu">
                                        <li><a href="category.html?category=1&subcategory=">Laptops & Tablets</a>
                                            <br>
                                            <ul>
                                                <li><a href="category.html?category=1&subcategory=1">Laptops</a></li>
                                                <li><a href="category.html?category=1&subcategory=2">Tablets</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="category.html?category=2&subcategory=">Electronics & Accessories</a>
                                            <br>
                                            <ul>
                                                <li><a href="category.html?category=2&subcategory=3">Keyboards & Mice</a></li>
                                                <li><a href="category.html?category=2&subcategory=4">Audio</a></li>
                                                <li><a href="category.html?category=2&subcategory=5">Hard Drives, SSDs & Storage</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="category.html?category=3&subcategory=">Printers</a>
                                            <br>
                                            <ul>
                                                <li><a href="category.html?category=3&subcategory=6">Inkjet Printers</a></li>
                                                <li><a href="category.html?category=3&subcategory=7">Laser Printers</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="category.html?category=1&subcategory=">Laptops & Tablets</a></li>
                                <li><a href="category.html?category=2&subcategory=">Electronics & Accessories</a></li>
                                <li><a href="category.html?category=3&subcategory=">Printers</a></li>
                                <li class="megamenu-holder"><a>Pages</a><i class="fa fa-angle-down"></i>
                                    <ul class="megamenu">
                                        <li>
                                            <ul>
                                                <li><a href="account.html">My Account</a></li>
                                                <li><a href="shopping-cart.html">Shopping Cart</a></li>
                                                <li><a href="checkout.html">Checkout</a></li>
                                                <li><a href="contact.html">Contact</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- Header Bottom Area End Here -->
            </header>
            <!-- Header Area End Here -->
            <!-- Begin Breadcrumb Area -->
            <div class="breadcrumb-area">
                <div class="container">
                    <div class="breadcrumb-content">
                        <ul>
                            <li><a href="index.html">Home</a></li>
                            <li class="active">Register</li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- Breadcrumb Area End Here -->
            <!-- Begin Register Area -->
            <div class="register-area mb-50">
                <div class="container">
                    <div class="row">
                        <div class="col-6">
                            <div class="section-title">
                                <h2>Create Your Account</h2>
                            </div><br><br>
                            <form action="#" class="register-form">
                                <div class="row">
                                    <div class="col-12">
                                        <input type="text" name="username" placeholder="Enter your username"> 
                                    </div>
                                    <div class="col-12">
                                        <input type="email" name="email" placeholder="Enter your email address"> 
                                    </div>
                                    <div class="col-6">
                                        <input type="password" name="password" placeholder="Enter your password"> 
                                    </div>
                                    <div class="col-6">
                                        <input type="password" name="confirmPassword" placeholder="Confirm your password"> 
                                    </div>                                    
                                    <div class="col-12" style="display: flex; align-items: center; position: relative; bottom: 10px;">
                                        <i class="fa fa-info-circle" style="color: #0673ca; margin-right: 5px;"></i>
                                        <p style="font-size: 12px;">Passwords must be at least 6 characters.</p>
                                    </div>
                                    <div class="col-12">
                                        <p style="font-size: 12px;">We take your privacy and security seriously. We are committed to safeguarding your personal information. When you log in to your account, we collect and use your data for authentication purposes only. We do not share your information with third parties without your consent. If you have any questions or concerns about your privacy or data security, please don't hesitate to contact our support team. </p>
                                    </div>
                                    <div class="col-12" style="display: flex; justify-content: flex-start; align-items: flex-start; padding-bottom: 10px;">
                                        <input type="checkbox" id="agree" name="agreement" value="agreed" style="margin-right: 10px;">
                                        <label for="agree" style="position: relative; bottom: 4.5px;">I agree to the terms and conditions.</label>    
                                    </div>
                                    <div class="col-12">
                                        <button class="my-button">Create Account</button>
                                    </div>
                                    <div class="col-12">
                                        <p>Already have an account? <a href="">Sign in</a> here.</p>
                                    </div>
                                    <div class="col-12 error-message">
                                        <div>
                                            <i class="fa fa-exclamation-triangle" style="margin-right: 5px; color: red;"></i><p></p>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="col-6">
                            <img src="images/login-register/screen-post-PinrXPzW7cU-unsplash.jpg" alt="">
                        </div>
                    </div>
                </div>
            </div>
            <!-- Register Area End Here -->
        </div>
        <!-- Body Wrapper End Here -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha512-jGsMH83oKe9asCpkOVkBnUrDDTp8wl+adkB2D+//JtlxO4SrLoJdhbOysIFQJloQFD+C4Fl1rMsQZF76JjV0eQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdn.usebootstrap.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js" integrity="sha512-bPs7Ae6pVvhOSiIcyUClR7/q2OAsRiovw4vAkX+zJbw3ShAeeqezq50RIIcIURq7Oa20rW2n2q+fyXBNcU9lrw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="js/jquery.meanmenu.min.js"></script>
        <script src="js/main.js"></script>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                // Get the elements
                const button = document.querySelector(".my-button");
                const usernameInput = document.querySelector(".register-form input[name='username']");
                const emailInput = document.querySelector(".register-form input[name='email']");
                const passwordInput = document.querySelector(".register-form input[name='password']");
                const confirmPasswordInput = document.querySelector(".register-form input[name='confirmPassword']");

                // Add click event to the Sign In button
                button.addEventListener("click", function (event) {
                    // Prevent the default form submission
                    event.preventDefault();

                    // Get the username and password values
                    const username = usernameInput.value;
                    const email = emailInput.value;
                    const password = passwordInput.value;
                    const confirmPassword = confirmPasswordInput.value;

                    // Make the API call with a Fetch POST request
                    register(username, email, password, confirmPassword);
                });
            });

            function register(username, email, password, confirmPassword) {

                // Check if the username or password is empty
                if (!username || !email || !password || !confirmPassword) {
                    document.querySelector('.error-message').style.display = 'block';
                    document.querySelector('.error-message p').innerText = 'Please fill in your credentials';
                    return;
                }

                // Check if the agreement checkbox is not checked
                const agreementCheckbox = document.getElementById('agree');
                if (!agreementCheckbox.checked) {
                    document.querySelector('.error-message').style.display = 'block';
                    document.querySelector('.error-message p').innerText = 'Please agree to the terms and conditions';
                    return;
                }

                fetch("http://localhost:8080/user/register", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        username: username,
                        email: email,
                        password: password,
                        confirmPassword: confirmPassword
                    }),
                })
                .then(response => {
                    if (!response.ok) {
                        return response.json().then(errorData => {
                            throw new Error(errorData.message);
                        });
                    }
                    return response.json();
                })
                .then(data => {
                    sessionStorage.setItem('userId', data.userId);

                    window.location.href = 'sign-in.html';
                })
                .catch(error => {
                    document.querySelector('.error-message').style.display = 'block';
                    document.querySelector('.error-message p').innerText = error.message;
                });
            }
        </script>
    </body>
</html>
